<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns, CPP, MagicHash, UnboxedTuples #-}</span><span>
</span><a name="line-2"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- Module      :  Control.Parallel.Strategies</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- Copyright   :  (c) The University of Glasgow 2001-2010</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- License     :  BSD-style (see the file libraries/base/LICENSE)</span><span>
</span><a name="line-7"></a><span class="hs-comment">--</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Maintainer  :  libraries@haskell.org</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Portability :  portable</span><span>
</span><a name="line-11"></a><span class="hs-comment">--</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- Parallel Evaluation Strategies, or Strategies for short, provide</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- ways to express parallel computations.  Strategies have the following</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- key features:</span><span>
</span><a name="line-15"></a><span class="hs-comment">--</span><span>
</span><a name="line-16"></a><span class="hs-comment">--  * Strategies express /deterministic parallelism/:</span><span>
</span><a name="line-17"></a><span class="hs-comment">--    the result of the program is unaffected by evaluating in parallel.</span><span>
</span><a name="line-18"></a><span class="hs-comment">--    The parallel tasks evaluated by a Strategy may have no side effects.</span><span>
</span><a name="line-19"></a><span class="hs-comment">--    For non-deterministic parallel programming, see &quot;Control.Concurrent&quot;.</span><span>
</span><a name="line-20"></a><span class="hs-comment">--</span><span>
</span><a name="line-21"></a><span class="hs-comment">--  * Strategies let you separate the description of the parallelism from the</span><span>
</span><a name="line-22"></a><span class="hs-comment">--    logic of your program, enabling modular parallelism.  The basic idea</span><span>
</span><a name="line-23"></a><span class="hs-comment">--    is to build a lazy data structure representing the computation, and</span><span>
</span><a name="line-24"></a><span class="hs-comment">--    then write a Strategy that describes how to traverse the data structure</span><span>
</span><a name="line-25"></a><span class="hs-comment">--    and evaluate components of it sequentially or in parallel.</span><span>
</span><a name="line-26"></a><span class="hs-comment">--</span><span>
</span><a name="line-27"></a><span class="hs-comment">--  * Strategies are /compositional/: larger strategies can be built</span><span>
</span><a name="line-28"></a><span class="hs-comment">--    by gluing together smaller ones.</span><span>
</span><a name="line-29"></a><span class="hs-comment">--</span><span>
</span><a name="line-30"></a><span class="hs-comment">--  * 'Monad' and 'Applicative' instances are provided, for quickly building</span><span>
</span><a name="line-31"></a><span class="hs-comment">--    strategies that involve traversing structures in a regular way.</span><span>
</span><a name="line-32"></a><span class="hs-comment">--</span><span>
</span><a name="line-33"></a><span class="hs-comment">-- For API history and changes in this release, see &quot;Control.Parallel.Strategies#history&quot;.</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Parallel</span><span class="hs-operator">.</span><span class="hs-identifier">Strategies</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-38"></a><span>         </span><span class="hs-comment">-- * The strategy type</span><span>
</span><a name="line-39"></a><span>         </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span>         </span><span class="hs-comment">-- * Application of strategies</span><span>
</span><a name="line-42"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#using"><span class="hs-identifier hs-var">using</span></a><span>             </span><span class="hs-comment">-- :: a -&gt; Strategy a -&gt; a</span><span>
</span><a name="line-43"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#withStrategy"><span class="hs-identifier hs-var">withStrategy</span></a><span>      </span><span class="hs-comment">-- :: Strategy a -&gt; a -&gt; a</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span>         </span><span class="hs-comment">-- * Composition of strategies</span><span>
</span><a name="line-46"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#dot"><span class="hs-identifier hs-var">dot</span></a><span>               </span><span class="hs-comment">-- :: Strategy a -&gt; Strategy a -&gt; Strategy a</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span>         </span><span class="hs-comment">-- * Basic strategies</span><span>
</span><a name="line-49"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#r0"><span class="hs-identifier hs-var">r0</span></a><span>                </span><span class="hs-comment">-- :: Strategy a</span><span>
</span><a name="line-50"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#rseq"><span class="hs-identifier hs-var">rseq</span></a><span>
</span><a name="line-51"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#rdeepseq"><span class="hs-identifier hs-var">rdeepseq</span></a><span>          </span><span class="hs-comment">-- :: NFData a =&gt; Strategy a</span><span>
</span><a name="line-52"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#rpar"><span class="hs-identifier hs-var">rpar</span></a><span>              </span><span class="hs-comment">-- :: Strategy a</span><span>
</span><a name="line-53"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">rparWith</span></a><span>          </span><span class="hs-comment">-- :: Strategy a -&gt; Strategy a</span><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span>         </span><span class="hs-comment">-- * Injection of sequential strategies</span><span>
</span><a name="line-56"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#evalSeq"><span class="hs-identifier hs-var">evalSeq</span></a><span>           </span><span class="hs-comment">-- :: Seq.Strategy a -&gt; Strategy a</span><span>
</span><a name="line-57"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#SeqStrategy"><span class="hs-identifier hs-type">SeqStrategy</span></a><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span>         </span><span class="hs-comment">-- * Strategies for traversable data types</span><span>
</span><a name="line-60"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#evalTraversable"><span class="hs-identifier hs-var">evalTraversable</span></a><span>   </span><span class="hs-comment">-- :: Traversable t =&gt; Strategy a -&gt; Strategy (t a)</span><span>
</span><a name="line-61"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#parTraversable"><span class="hs-identifier hs-var">parTraversable</span></a><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span>         </span><span class="hs-comment">-- * Strategies for lists</span><span>
</span><a name="line-64"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#evalList"><span class="hs-identifier hs-var">evalList</span></a><span>          </span><span class="hs-comment">-- :: Strategy a -&gt; Strategy [a]</span><span>
</span><a name="line-65"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#parList"><span class="hs-identifier hs-var">parList</span></a><span>
</span><a name="line-66"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#evalListN"><span class="hs-identifier hs-var">evalListN</span></a><span>         </span><span class="hs-comment">-- :: Int -&gt; Strategy a -&gt; Strategy [a]</span><span>
</span><a name="line-67"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#parListN"><span class="hs-identifier hs-var">parListN</span></a><span>
</span><a name="line-68"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#evalListNth"><span class="hs-identifier hs-var">evalListNth</span></a><span>       </span><span class="hs-comment">-- :: Int -&gt; Strategy a -&gt; Strategy [a]</span><span>
</span><a name="line-69"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#parListNth"><span class="hs-identifier hs-var">parListNth</span></a><span>
</span><a name="line-70"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#evalListSplitAt"><span class="hs-identifier hs-var">evalListSplitAt</span></a><span>   </span><span class="hs-comment">-- :: Int -&gt; Strategy [a] -&gt; Strategy [a] -&gt; Strategy [a]</span><span>
</span><a name="line-71"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#parListSplitAt"><span class="hs-identifier hs-var">parListSplitAt</span></a><span>
</span><a name="line-72"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#parListChunk"><span class="hs-identifier hs-var">parListChunk</span></a><span>
</span><a name="line-73"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#parMap"><span class="hs-identifier hs-var">parMap</span></a><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span>         </span><span class="hs-comment">-- ** Strategies for lazy lists</span><span>
</span><a name="line-76"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#evalBuffer"><span class="hs-identifier hs-var">evalBuffer</span></a><span>        </span><span class="hs-comment">-- :: Int -&gt; Strategy a -&gt; Strategy [a]</span><span>
</span><a name="line-77"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#parBuffer"><span class="hs-identifier hs-var">parBuffer</span></a><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span>         </span><span class="hs-comment">-- * Strategies for tuples</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span>         </span><span class="hs-comment">-- | Evaluate the components of a tuple according to the</span><span>
</span><a name="line-82"></a><span>         </span><span class="hs-comment">-- given strategies.</span><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#evalTuple2"><span class="hs-identifier hs-var">evalTuple2</span></a><span>        </span><span class="hs-comment">-- :: Strategy a -&gt; ... -&gt; Strategy (a,...)</span><span>
</span><a name="line-85"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#evalTuple3"><span class="hs-identifier hs-var">evalTuple3</span></a><span>
</span><a name="line-86"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#evalTuple4"><span class="hs-identifier hs-var">evalTuple4</span></a><span>
</span><a name="line-87"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#evalTuple5"><span class="hs-identifier hs-var">evalTuple5</span></a><span>
</span><a name="line-88"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#evalTuple6"><span class="hs-identifier hs-var">evalTuple6</span></a><span>
</span><a name="line-89"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#evalTuple7"><span class="hs-identifier hs-var">evalTuple7</span></a><span>
</span><a name="line-90"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#evalTuple8"><span class="hs-identifier hs-var">evalTuple8</span></a><span>
</span><a name="line-91"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#evalTuple9"><span class="hs-identifier hs-var">evalTuple9</span></a><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span>       </span><span class="hs-comment">-- | Evaluate the components of a tuple in parallel according to</span><span>
</span><a name="line-95"></a><span>       </span><span class="hs-comment">-- the given strategies.</span><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#parTuple2"><span class="hs-identifier hs-var">parTuple2</span></a><span>         </span><span class="hs-comment">-- :: Strategy a -&gt; ... -&gt; Strategy (a,...)</span><span>
</span><a name="line-98"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#parTuple3"><span class="hs-identifier hs-var">parTuple3</span></a><span>
</span><a name="line-99"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#parTuple4"><span class="hs-identifier hs-var">parTuple4</span></a><span>
</span><a name="line-100"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#parTuple5"><span class="hs-identifier hs-var">parTuple5</span></a><span>
</span><a name="line-101"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#parTuple6"><span class="hs-identifier hs-var">parTuple6</span></a><span>
</span><a name="line-102"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#parTuple7"><span class="hs-identifier hs-var">parTuple7</span></a><span>
</span><a name="line-103"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#parTuple8"><span class="hs-identifier hs-var">parTuple8</span></a><span>
</span><a name="line-104"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#parTuple9"><span class="hs-identifier hs-var">parTuple9</span></a><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span>         </span><span class="hs-comment">-- * Strategic function application</span><span>
</span><a name="line-107"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Control.Parallel.Strategies.html#%24%7C"><span class="hs-operator hs-var">$|</span></a><span class="hs-special">)</span><span>              </span><span class="hs-comment">-- :: (a -&gt; b) -&gt; Strategy a -&gt; a -&gt; b</span><span>
</span><a name="line-108"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Control.Parallel.Strategies.html#%24%7C%7C"><span class="hs-operator hs-var">$||</span></a><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Control.Parallel.Strategies.html#.%7C"><span class="hs-operator hs-var">.|</span></a><span class="hs-special">)</span><span>              </span><span class="hs-comment">-- :: (b -&gt; c) -&gt; Strategy b -&gt; (a -&gt; b) -&gt; a -&gt; c</span><span>
</span><a name="line-110"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Control.Parallel.Strategies.html#.%7C%7C"><span class="hs-operator hs-var">.||</span></a><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Control.Parallel.Strategies.html#-%7C"><span class="hs-operator hs-var">-|</span></a><span class="hs-special">)</span><span>              </span><span class="hs-comment">-- :: (a -&gt; b) -&gt; Strategy b -&gt; (b -&gt; c) -&gt; a -&gt; c</span><span>
</span><a name="line-112"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Control.Parallel.Strategies.html#-%7C%7C"><span class="hs-operator hs-var">-||</span></a><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span>         </span><span class="hs-comment">-- * For Strategy programmers</span><span>
</span><a name="line-115"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#Eval"><span class="hs-identifier hs-type">Eval</span></a><span>              </span><span class="hs-comment">-- instances: Monad, Functor, Applicative</span><span>
</span><a name="line-116"></a><span>       </span><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#runEval"><span class="hs-identifier hs-var">runEval</span></a><span>           </span><span class="hs-comment">-- :: Eval a -&gt; a</span><span>
</span><a name="line-117"></a><span>       </span><span class="hs-special">,</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span>    </span><span class="hs-comment">-- * API History</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span>    </span><span class="hs-comment">-- $history</span><span>
</span><a name="line-122"></a><span>
</span><a name="line-123"></a><span>    </span><span class="hs-comment">-- * Backwards compatibility</span><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span>    </span><span class="hs-comment">-- | These functions and types are all deprecated, and will be</span><span>
</span><a name="line-126"></a><span>    </span><span class="hs-comment">-- removed in a future release.  In all cases they have been</span><span>
</span><a name="line-127"></a><span>    </span><span class="hs-comment">-- either renamed or replaced with equivalent functionality.</span><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span>    </span><a href="Control.Parallel.Strategies.html#Done"><span class="hs-identifier hs-type">Done</span></a><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#demanding"><span class="hs-identifier hs-var">demanding</span></a><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#sparking"><span class="hs-identifier hs-var">sparking</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Control.Parallel.Strategies.html#%3E%7C"><span class="hs-operator hs-var">&gt;|</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Control.Parallel.Strategies.html#%3E%7C%7C"><span class="hs-operator hs-var">&gt;||</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-130"></a><span>    </span><a href="Control.Parallel.Strategies.html#rwhnf"><span class="hs-identifier hs-var">rwhnf</span></a><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#unEval"><span class="hs-identifier hs-var">unEval</span></a><span class="hs-special">,</span><span>
</span><a name="line-131"></a><span>    </span><a href="Control.Parallel.Strategies.html#seqTraverse"><span class="hs-identifier hs-var">seqTraverse</span></a><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#parTraverse"><span class="hs-identifier hs-var">parTraverse</span></a><span class="hs-special">,</span><span>
</span><a name="line-132"></a><span>    </span><a href="Control.Parallel.Strategies.html#seqList"><span class="hs-identifier hs-var">seqList</span></a><span class="hs-special">,</span><span>
</span><a name="line-133"></a><span>    </span><a href="Control.Parallel.Strategies.html#seqPair"><span class="hs-identifier hs-var">seqPair</span></a><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#parPair"><span class="hs-identifier hs-var">parPair</span></a><span class="hs-special">,</span><span>
</span><a name="line-134"></a><span>    </span><a href="Control.Parallel.Strategies.html#seqTriple"><span class="hs-identifier hs-var">seqTriple</span></a><span class="hs-special">,</span><span> </span><a href="Control.Parallel.Strategies.html#parTriple"><span class="hs-identifier hs-var">parTriple</span></a><span class="hs-special">,</span><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span>    </span><span class="hs-comment">-- * For API completeness</span><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span>    </span><span class="hs-comment">-- | so users of 'rdeepseq' aren't required to import Control.DeepSeq:</span><span>
</span><a name="line-139"></a><span>    </span><span class="hs-identifier hs-type">NFData</span><span>
</span><a name="line-140"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-141"></a><span>
</span><a name="line-142"></a><span class="hs-cpp">#if !MIN_VERSION_base(4,8,0)</span><span>
</span><a name="line-143"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Traversable</span><span>
</span><a name="line-144"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Applicative</span><span>
</span><a name="line-145"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-146"></a><span class="hs-keyword">import</span><span> </span><a href="Control.Parallel.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Parallel</span></a><span>
</span><a name="line-147"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">DeepSeq</span><span>
</span><a name="line-148"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Control.Seq.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Seq</span></a><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Exts</span><span>
</span><a name="line-153"></a><span>
</span><a name="line-154"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">dot</span><span class="hs-special">`</span><span>     </span><span class="hs-comment">-- same as (.)</span><span>
</span><a name="line-155"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">using</span><span class="hs-special">`</span><span>   </span><span class="hs-comment">-- lowest precedence and associate to the left</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><a name="line-158"></a><span class="hs-comment">-- Eval monad (isomorphic to Lift monad from MonadLib 3.6.1)</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-comment">-- | 'Eval' is a Monad that makes it easier to define parallel</span><span>
</span><a name="line-161"></a><span class="hs-comment">-- strategies.  It is a strict identity monad: that is, in</span><span>
</span><a name="line-162"></a><span class="hs-comment">--</span><span>
</span><a name="line-163"></a><span class="hs-comment">--  &gt; m &gt;&gt;= f</span><span>
</span><a name="line-164"></a><span class="hs-comment">--</span><span>
</span><a name="line-165"></a><span class="hs-comment">-- @m@ is evaluated before the result is passed to @f@.</span><span>
</span><a name="line-166"></a><span class="hs-comment">--</span><span>
</span><a name="line-167"></a><span class="hs-comment">--  &gt; instance Monad Eval where</span><span>
</span><a name="line-168"></a><span class="hs-comment">--  &gt;   return  = Done</span><span>
</span><a name="line-169"></a><span class="hs-comment">--  &gt;   m &gt;&gt;= k = case m of</span><span>
</span><a name="line-170"></a><span class="hs-comment">--  &gt;               Done x -&gt; k x</span><span>
</span><a name="line-171"></a><span class="hs-comment">--</span><span>
</span><a name="line-172"></a><span class="hs-comment">-- If you wanted to construct a 'Strategy' for a pair that sparked the</span><span>
</span><a name="line-173"></a><span class="hs-comment">-- first component in parallel and then evaluated the second</span><span>
</span><a name="line-174"></a><span class="hs-comment">-- component, you could write</span><span>
</span><a name="line-175"></a><span class="hs-comment">--</span><span>
</span><a name="line-176"></a><span class="hs-comment">-- &gt; myStrat :: Strategy (a,b)</span><span>
</span><a name="line-177"></a><span class="hs-comment">-- &gt; myStrat (a,b) = do { a' &lt;- rpar a; b' &lt;- rseq b; return (a',b') }</span><span>
</span><a name="line-178"></a><span class="hs-comment">--</span><span>
</span><a name="line-179"></a><span class="hs-comment">-- Alternatively, you could write this more compactly using the</span><span>
</span><a name="line-180"></a><span class="hs-comment">-- Applicative style as</span><span>
</span><a name="line-181"></a><span class="hs-comment">--</span><span>
</span><a name="line-182"></a><span class="hs-comment">-- &gt; myStrat (a,b) = (,) &lt;$&gt; rpar a &lt;*&gt; rseq b</span><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-comment">-- More examples, using the Applicative instance:</span><span>
</span><a name="line-185"></a><span class="hs-comment">--</span><span>
</span><a name="line-186"></a><span class="hs-comment">-- &gt; parList :: Strategy a -&gt; Strategy [a]</span><span>
</span><a name="line-187"></a><span class="hs-comment">-- &gt; parList strat = traverse (rpar `dot` strat))</span><span>
</span><a name="line-188"></a><span class="hs-comment">--</span><span>
</span><a name="line-189"></a><span class="hs-comment">-- &gt; evalPair :: Strategy a -&gt; Strategy b -&gt; Strategy (a,b)</span><span>
</span><a name="line-190"></a><span class="hs-comment">-- &gt; evalPair f g (a,b) = pure (,) &lt;$&gt; f a &lt;*&gt; g b</span><span>
</span><a name="line-191"></a><span class="hs-comment">--</span><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 702</span><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span class="hs-keyword">newtype</span><span> </span><a name="Eval"><a href="Control.Parallel.Strategies.html#Eval"><span class="hs-identifier">Eval</span></a></a><span> </span><a name="local-1627413493"><a href="#local-1627413493"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Eval"><a href="Control.Parallel.Strategies.html#Eval"><span class="hs-identifier">Eval</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">State</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-identifier hs-type">RealWorld</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier hs-type">State</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-identifier hs-type">RealWorld</span><span class="hs-special">,</span><span> </span><a href="#local-1627413493"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-196"></a><span>  </span><span class="hs-comment">-- GHC 7.2.1 added the seq# and spark# primitives, that we use in</span><span>
</span><a name="line-197"></a><span>  </span><span class="hs-comment">-- the Eval monad implementation in order to get the correct</span><span>
</span><a name="line-198"></a><span>  </span><span class="hs-comment">-- strictness behaviour.</span><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span class="hs-comment">-- | Pull the result out of the monad.</span><span>
</span><a name="line-201"></a><span class="hs-identifier">runEval</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Parallel.Strategies.html#Eval"><span class="hs-identifier hs-type">Eval</span></a><span> </span><a href="#local-1627414123"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627414123"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-202"></a><a name="runEval"><a href="Control.Parallel.Strategies.html#runEval"><span class="hs-identifier">runEval</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Parallel.Strategies.html#Eval"><span class="hs-identifier hs-var">Eval</span></a><span> </span><a name="local-1627414124"><a href="#local-1627414124"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627414124"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-identifier hs-var">realWorld</span><span class="hs-operator hs-var">#</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627414125"><a href="#local-1627414125"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627414125"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-203"></a><span>
</span><a name="line-204"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="Control.Parallel.Strategies.html#Eval"><span class="hs-identifier hs-type">Eval</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-205"></a><span>  </span><a name="local-805306541"><span class="hs-identifier">fmap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftM</span><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><a href="Control.Parallel.Strategies.html#Eval"><span class="hs-identifier hs-type">Eval</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-208"></a><span>  </span><a name="local-805307120"><span class="hs-identifier">pure</span></a><span> </span><a name="local-1627414569"><a href="#local-1627414569"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Parallel.Strategies.html#Eval"><span class="hs-identifier hs-var">Eval</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-1627414570"><a href="#local-1627414570"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="#local-1627414570"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627414569"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-209"></a><span>  </span><span class="hs-special">(</span><a name="local-805307119"><span class="hs-operator">&lt;*&gt;</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ap</span><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="Control.Parallel.Strategies.html#Eval"><span class="hs-identifier hs-type">Eval</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-212"></a><span>  </span><a name="local-805306542"><span class="hs-identifier">return</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span>
</span><a name="line-213"></a><span>  </span><a href="Control.Parallel.Strategies.html#Eval"><span class="hs-identifier hs-var">Eval</span></a><span> </span><a name="local-1627414563"><a href="#local-1627414563"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-805306539"><span class="hs-operator">&gt;&gt;=</span></a><span> </span><a name="local-1627414564"><a href="#local-1627414564"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Parallel.Strategies.html#Eval"><span class="hs-identifier hs-var">Eval</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-1627414565"><a href="#local-1627414565"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627414563"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627414565"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-214"></a><span>                                </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a name="local-1627414566"><a href="#local-1627414566"><span class="hs-identifier">s'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627414567"><a href="#local-1627414567"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627414564"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-1627414567"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-215"></a><span>                                                      </span><a href="Control.Parallel.Strategies.html#Eval"><span class="hs-identifier hs-var">Eval</span></a><span> </span><a name="local-1627414568"><a href="#local-1627414568"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627414568"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627414566"><span class="hs-identifier hs-var">s'</span></a><span>
</span><a name="line-216"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-217"></a><span>
</span><a name="line-218"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Eval</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Done</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-219"></a><span>
</span><a name="line-220"></a><span class="hs-comment">-- | Pull the result out of the monad.</span><span>
</span><a name="line-221"></a><span class="hs-identifier">runEval</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Eval</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-222"></a><span class="hs-identifier">runEval</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Done</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-223"></a><span>
</span><a name="line-224"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Functor</span><span> </span><span class="hs-identifier">Eval</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-225"></a><span>  </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">liftM</span><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-identifier">Eval</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-228"></a><span>  </span><span class="hs-identifier">pure</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Done</span><span>
</span><a name="line-229"></a><span>  </span><span class="hs-special">(</span><span class="hs-operator">&lt;*&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ap</span><span>
</span><a name="line-230"></a><span>
</span><a name="line-231"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Monad</span><span> </span><span class="hs-identifier">Eval</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-232"></a><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pure</span><span>
</span><a name="line-233"></a><span>  </span><span class="hs-identifier">Done</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">&gt;&gt;=</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lazy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">k</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- Note: pattern 'Done x' makes '&gt;&gt;=' strict</span><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-pragma">{-# RULES &quot;lazy Done&quot; forall x . lazy (Done x) = Done x #-}</span><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span class="hs-comment">-- The Eval monad satisfies the monad laws.</span><span>
</span><a name="line-241"></a><span class="hs-comment">--</span><span>
</span><a name="line-242"></a><span class="hs-comment">-- (1) Left identity:</span><span>
</span><a name="line-243"></a><span class="hs-comment">--     return x &gt;&gt;= f ==&gt; Done x &gt;&gt;= f ==&gt; f x</span><span>
</span><a name="line-244"></a><span class="hs-comment">--</span><span>
</span><a name="line-245"></a><span class="hs-comment">-- (2) Right identity:</span><span>
</span><a name="line-246"></a><span class="hs-comment">--     (i)  m &gt;&gt;= return =*&gt; Done u &gt;&gt;= return</span><span>
</span><a name="line-247"></a><span class="hs-comment">--                       ==&gt; return u</span><span>
</span><a name="line-248"></a><span class="hs-comment">--                       ==&gt; Done u &lt;*= m</span><span>
</span><a name="line-249"></a><span class="hs-comment">--     (ii) m &gt;&gt;= return =*&gt; undefined &gt;&gt;= return</span><span>
</span><a name="line-250"></a><span class="hs-comment">--                       ==&gt; undefined &lt;*= m</span><span>
</span><a name="line-251"></a><span class="hs-comment">--</span><span>
</span><a name="line-252"></a><span class="hs-comment">-- (3) Associativity:</span><span>
</span><a name="line-253"></a><span class="hs-comment">--     (i)  (m &gt;&gt;= f) &gt;&gt;= g =*&gt; (Done u &gt;&gt;= f) &gt;&gt;= g</span><span>
</span><a name="line-254"></a><span class="hs-comment">--                          ==&gt; f u &gt;&gt;= g &lt;== (\x -&gt; f x &gt;&gt;= g) u</span><span>
</span><a name="line-255"></a><span class="hs-comment">--                                        &lt;== Done u &gt;&gt;= (\x -&gt; f x &gt;&gt;= g)</span><span>
</span><a name="line-256"></a><span class="hs-comment">--                                        &lt;*= m &gt;&gt;= (\x -&gt; f x &gt;&gt;= g)</span><span>
</span><a name="line-257"></a><span class="hs-comment">--     (ii) (m &gt;&gt;= f) &gt;&gt;= g =*&gt; (undefined &gt;&gt;= f) &gt;&gt;= g</span><span>
</span><a name="line-258"></a><span class="hs-comment">--                          ==&gt; undefined &gt;&gt;= g</span><span>
</span><a name="line-259"></a><span class="hs-comment">--                          ==&gt; undefined &lt;== undefined &gt;&gt;= (\x -&gt; f x &gt;&gt;= g)</span><span>
</span><a name="line-260"></a><span class="hs-comment">--                                        &lt;*= m &gt;&gt;= (\x -&gt; f x &gt;&gt;= g)</span><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><a name="line-264"></a><span class="hs-comment">-- Strategies</span><span>
</span><a name="line-265"></a><span>
</span><a name="line-266"></a><span class="hs-comment">-- | A 'Strategy' is a function that embodies a parallel evaluation strategy.</span><span>
</span><a name="line-267"></a><span class="hs-comment">-- The function traverses (parts of) its argument, evaluating subexpressions</span><span>
</span><a name="line-268"></a><span class="hs-comment">-- in parallel or in sequence.</span><span>
</span><a name="line-269"></a><span class="hs-comment">--</span><span>
</span><a name="line-270"></a><span class="hs-comment">-- A 'Strategy' may do an arbitrary amount of evaluation of its</span><span>
</span><a name="line-271"></a><span class="hs-comment">-- argument, but should not return a value different from the one it</span><span>
</span><a name="line-272"></a><span class="hs-comment">-- was passed.</span><span>
</span><a name="line-273"></a><span class="hs-comment">--</span><span>
</span><a name="line-274"></a><span class="hs-comment">-- Parallel computations may be discarded by the runtime system if the</span><span>
</span><a name="line-275"></a><span class="hs-comment">-- program no longer requires their result, which is why a 'Strategy'</span><span>
</span><a name="line-276"></a><span class="hs-comment">-- function returns a new value equivalent to the old value.  The</span><span>
</span><a name="line-277"></a><span class="hs-comment">-- intention is that the program applies the 'Strategy' to a</span><span>
</span><a name="line-278"></a><span class="hs-comment">-- structure, and then uses the returned value, discarding the old</span><span>
</span><a name="line-279"></a><span class="hs-comment">-- value.  This idiom is expressed by the 'using' function.</span><span>
</span><a name="line-280"></a><span class="hs-comment">--</span><span>
</span><a name="line-281"></a><span class="hs-keyword">type</span><span> </span><a name="Strategy"><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier">Strategy</span></a></a><span> </span><a name="local-1627413492"><a href="#local-1627413492"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627413492"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Eval"><span class="hs-identifier hs-type">Eval</span></a><span> </span><a href="#local-1627413492"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-282"></a><span>
</span><a name="line-283"></a><span class="hs-comment">-- | Evaluate a value using the given 'Strategy'.</span><span>
</span><a name="line-284"></a><span class="hs-comment">--</span><span>
</span><a name="line-285"></a><span class="hs-comment">-- &gt; x `using` s = runEval (s x)</span><span>
</span><a name="line-286"></a><span class="hs-comment">--</span><span>
</span><a name="line-287"></a><span class="hs-identifier">using</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-1627414122"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414122"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627414122"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-288"></a><a name="local-1627414126"><a href="#local-1627414126"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><a name="using"><a href="Control.Parallel.Strategies.html#using"><span class="hs-identifier">using</span></a></a><span class="hs-special">`</span><span> </span><a name="local-1627414127"><a href="#local-1627414127"><span class="hs-identifier">strat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Parallel.Strategies.html#runEval"><span class="hs-identifier hs-var">runEval</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627414127"><span class="hs-identifier hs-var">strat</span></a><span> </span><a href="#local-1627414126"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-289"></a><span>
</span><a name="line-290"></a><span class="hs-comment">-- | evaluate a value using the given 'Strategy'.  This is simply</span><span>
</span><a name="line-291"></a><span class="hs-comment">-- 'using' with the arguments reversed.</span><span>
</span><a name="line-292"></a><span class="hs-comment">--</span><span>
</span><a name="line-293"></a><span class="hs-identifier">withStrategy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414121"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627414121"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627414121"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-294"></a><a name="withStrategy"><a href="Control.Parallel.Strategies.html#withStrategy"><span class="hs-identifier">withStrategy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Control.Parallel.Strategies.html#using"><span class="hs-identifier hs-var">using</span></a><span>
</span><a name="line-295"></a><span>
</span><a name="line-296"></a><span class="hs-comment">-- | Compose two strategies sequentially.</span><span>
</span><a name="line-297"></a><span class="hs-comment">-- This is the analogue to function composition on strategies.</span><span>
</span><a name="line-298"></a><span class="hs-comment">--</span><span>
</span><a name="line-299"></a><span class="hs-comment">-- &gt; strat2 `dot` strat1 == strat2 . withStrategy strat1</span><span>
</span><a name="line-300"></a><span class="hs-comment">--</span><span>
</span><a name="line-301"></a><span class="hs-identifier">dot</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414120"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414120"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414120"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-302"></a><a name="local-1627414128"><a href="#local-1627414128"><span class="hs-identifier">strat2</span></a></a><span> </span><span class="hs-special">`</span><a name="dot"><a href="Control.Parallel.Strategies.html#dot"><span class="hs-identifier">dot</span></a></a><span class="hs-special">`</span><span> </span><a name="local-1627414129"><a href="#local-1627414129"><span class="hs-identifier">strat1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627414128"><span class="hs-identifier hs-var">strat2</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Parallel.Strategies.html#runEval"><span class="hs-identifier hs-var">runEval</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-1627414129"><span class="hs-identifier hs-var">strat1</span></a><span>
</span><a name="line-303"></a><span>
</span><a name="line-304"></a><span class="hs-comment">-- Proof of strat2 `dot` strat1 == strat2 . withStrategy strat1</span><span>
</span><a name="line-305"></a><span class="hs-comment">--</span><span>
</span><a name="line-306"></a><span class="hs-comment">--    strat2 . withStrategy strat1</span><span>
</span><a name="line-307"></a><span class="hs-comment">-- == \x -&gt; strat2 (withStrategy strat1 x)</span><span>
</span><a name="line-308"></a><span class="hs-comment">-- == \x -&gt; strat2 (x `using` strat1)</span><span>
</span><a name="line-309"></a><span class="hs-comment">-- == \x -&gt; strat2 (runEval (strat1 x))</span><span>
</span><a name="line-310"></a><span class="hs-comment">-- == \x -&gt; (strat2 . runEval . strat1) x</span><span>
</span><a name="line-311"></a><span class="hs-comment">-- == strat2 `dot` strat1</span><span>
</span><a name="line-312"></a><span>
</span><a name="line-313"></a><span class="hs-comment">-- One might be tempted to think that 'dot' is equivalent to '(&lt;=&lt;)',</span><span>
</span><a name="line-314"></a><span class="hs-comment">-- the right-to-left Kleisli composition in the Eval monad, because</span><span>
</span><a name="line-315"></a><span class="hs-comment">-- '(&lt;=&lt;)' can take the type @Strategy a -&gt; Strategy a -&gt; Strategy a@</span><span>
</span><a name="line-316"></a><span class="hs-comment">-- and intuitively does what 'dot' does: First apply the strategy to the</span><span>
</span><a name="line-317"></a><span class="hs-comment">-- right then the one to the left. However, there is a subtle difference</span><span>
</span><a name="line-318"></a><span class="hs-comment">-- in strictness, witnessed by the following example:</span><span>
</span><a name="line-319"></a><span class="hs-comment">--</span><span>
</span><a name="line-320"></a><span class="hs-comment">-- &gt; (r0 `dot` rseq) undefined == Done undefined</span><span>
</span><a name="line-321"></a><span class="hs-comment">-- &gt; (r0 &lt;=&lt; rseq) undefined == undefined</span><span>
</span><a name="line-322"></a><span class="hs-comment">--</span><span>
</span><a name="line-323"></a><span>
</span><a name="line-324"></a><span class="hs-comment">-- | Inject a sequential strategy (ie. coerce a sequential strategy</span><span>
</span><a name="line-325"></a><span class="hs-comment">-- to a general strategy).</span><span>
</span><a name="line-326"></a><span class="hs-comment">--</span><span>
</span><a name="line-327"></a><span class="hs-comment">-- Thanks to 'evalSeq', the type @Control.Seq.Strategy a@ is a subtype</span><span>
</span><a name="line-328"></a><span class="hs-comment">-- of @'Strategy' a@.</span><span>
</span><a name="line-329"></a><span class="hs-identifier">evalSeq</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Parallel.Strategies.html#SeqStrategy"><span class="hs-identifier hs-type">SeqStrategy</span></a><span> </span><a href="#local-1627414119"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414119"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-330"></a><a name="evalSeq"><a href="Control.Parallel.Strategies.html#evalSeq"><span class="hs-identifier">evalSeq</span></a></a><span> </span><a name="local-1627414130"><a href="#local-1627414130"><span class="hs-identifier">strat</span></a></a><span> </span><a name="local-1627414131"><a href="#local-1627414131"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627414130"><span class="hs-identifier hs-var">strat</span></a><span> </span><a href="#local-1627414131"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="Control.Parallel.html#pseq"><span class="hs-identifier hs-var">pseq</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-1627414131"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-331"></a><span>
</span><a name="line-332"></a><span class="hs-comment">-- | A name for @Control.Seq.Strategy@, for documentation only.</span><span>
</span><a name="line-333"></a><span class="hs-keyword">type</span><span> </span><a name="SeqStrategy"><a href="Control.Parallel.Strategies.html#SeqStrategy"><span class="hs-identifier">SeqStrategy</span></a></a><span> </span><a name="local-1627413491"><a href="#local-1627413491"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Seq.html#Strategy"><span class="hs-identifier hs-type">Control</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Seq</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627413491"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-334"></a><span>
</span><a name="line-335"></a><span class="hs-comment">-- --------------------------------------------------------------------------</span><span>
</span><a name="line-336"></a><span class="hs-comment">-- Basic strategies (some imported from SeqStrategies)</span><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span class="hs-comment">-- | 'r0' performs *no* evaluation.</span><span>
</span><a name="line-339"></a><span class="hs-comment">--</span><span>
</span><a name="line-340"></a><span class="hs-comment">-- &gt; r0 == evalSeq Control.Seq.r0</span><span>
</span><a name="line-341"></a><span class="hs-comment">--</span><span>
</span><a name="line-342"></a><span class="hs-identifier">r0</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414118"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-343"></a><a name="r0"><a href="Control.Parallel.Strategies.html#r0"><span class="hs-identifier">r0</span></a></a><span> </span><a name="local-1627414132"><a href="#local-1627414132"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-1627414132"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-344"></a><span>
</span><a name="line-345"></a><span class="hs-comment">-- Proof of r0 == evalSeq Control.Seq.r0</span><span>
</span><a name="line-346"></a><span class="hs-comment">--</span><span>
</span><a name="line-347"></a><span class="hs-comment">--    evalSeq Control.Seq.r0</span><span>
</span><a name="line-348"></a><span class="hs-comment">-- == \x -&gt; Control.Seq.r0 x `pseq` return x</span><span>
</span><a name="line-349"></a><span class="hs-comment">-- == \x -&gt; Control.Seq.Done `pseq` return x</span><span>
</span><a name="line-350"></a><span class="hs-comment">-- == \x -&gt; return x</span><span>
</span><a name="line-351"></a><span class="hs-comment">-- == r0</span><span>
</span><a name="line-352"></a><span>
</span><a name="line-353"></a><span class="hs-comment">-- | 'rseq' evaluates its argument to weak head normal form.</span><span>
</span><a name="line-354"></a><span class="hs-comment">--</span><span>
</span><a name="line-355"></a><span class="hs-comment">-- &gt; rseq == evalSeq Control.Seq.rseq</span><span>
</span><a name="line-356"></a><span class="hs-comment">--</span><span>
</span><a name="line-357"></a><span class="hs-identifier">rseq</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414117"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-358"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 702</span><span>
</span><a name="line-359"></a><a name="rseq"><a href="Control.Parallel.Strategies.html#rseq"><span class="hs-identifier">rseq</span></a></a><span> </span><a name="local-1627414133"><a href="#local-1627414133"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Parallel.Strategies.html#Eval"><span class="hs-identifier hs-var">Eval</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-1627414134"><a href="#local-1627414134"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">seq</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-1627414133"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627414134"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-360"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-361"></a><span class="hs-identifier">rseq</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-362"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-363"></a><span>
</span><a name="line-364"></a><span class="hs-comment">-- Proof of rseq == evalSeq Control.Seq.rseq</span><span>
</span><a name="line-365"></a><span class="hs-comment">--</span><span>
</span><a name="line-366"></a><span class="hs-comment">--    evalSeq Control.Seq.rseq</span><span>
</span><a name="line-367"></a><span class="hs-comment">-- == \x -&gt; Control.Seq.rseq x `pseq` return x</span><span>
</span><a name="line-368"></a><span class="hs-comment">-- == \x -&gt; (x `seq` Control.Seq.Done) `pseq` return x</span><span>
</span><a name="line-369"></a><span class="hs-comment">-- == \x -&gt; x `pseq` return x</span><span>
</span><a name="line-370"></a><span class="hs-comment">-- == rseq</span><span>
</span><a name="line-371"></a><span>
</span><a name="line-372"></a><span class="hs-comment">-- | 'rdeepseq' fully evaluates its argument.</span><span>
</span><a name="line-373"></a><span class="hs-comment">--</span><span>
</span><a name="line-374"></a><span class="hs-comment">-- &gt; rdeepseq == evalSeq Control.Seq.rdeepseq</span><span>
</span><a name="line-375"></a><span class="hs-comment">--</span><span>
</span><a name="line-376"></a><span class="hs-identifier">rdeepseq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="#local-1627414116"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414116"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-377"></a><a name="rdeepseq"><a href="Control.Parallel.Strategies.html#rdeepseq"><span class="hs-identifier">rdeepseq</span></a></a><span> </span><a name="local-1627414135"><a href="#local-1627414135"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="Control.Parallel.Strategies.html#rseq"><span class="hs-identifier hs-var">rseq</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">rnf</span><span> </span><a href="#local-1627414135"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-1627414135"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-378"></a><span>
</span><a name="line-379"></a><span class="hs-comment">-- Proof of rdeepseq == evalSeq Control.Seq.rdeepseq</span><span>
</span><a name="line-380"></a><span class="hs-comment">--</span><span>
</span><a name="line-381"></a><span class="hs-comment">--    evalSeq Control.Seq.rdeepseq</span><span>
</span><a name="line-382"></a><span class="hs-comment">-- == \x -&gt; Control.Seq.rdeepseq x `pseq` return x</span><span>
</span><a name="line-383"></a><span class="hs-comment">-- == \x -&gt; (x `deepseq` Control.Seq.Done) `pseq` return x</span><span>
</span><a name="line-384"></a><span class="hs-comment">-- == \x -&gt; (rnf x `seq` Control.Seq.Done) `pseq` return x</span><span>
</span><a name="line-385"></a><span class="hs-comment">-- == \x -&gt; rnf x `pseq` return x</span><span>
</span><a name="line-386"></a><span class="hs-comment">-- == rdeepseq</span><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span class="hs-comment">-- | 'rpar' sparks its argument (for evaluation in parallel).</span><span>
</span><a name="line-389"></a><span class="hs-identifier">rpar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414115"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-390"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 702</span><span>
</span><a name="line-391"></a><a name="rpar"><a href="Control.Parallel.Strategies.html#rpar"><span class="hs-identifier">rpar</span></a></a><span>  </span><a name="local-1627414136"><a href="#local-1627414136"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Parallel.Strategies.html#Eval"><span class="hs-identifier hs-var">Eval</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-1627414137"><a href="#local-1627414137"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">spark</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-1627414136"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627414137"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-392"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-393"></a><span class="hs-identifier">rpar</span><span>  </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">par</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Done</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-394"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-395"></a><span class="hs-pragma">{-# INLINE rpar  #-}</span><span>
</span><a name="line-396"></a><span>
</span><a name="line-397"></a><span class="hs-comment">-- | instead of saying @rpar `dot` strat@, you can say</span><span>
</span><a name="line-398"></a><span class="hs-comment">-- @rparWith strat@.  Compared to 'rpar', 'rparWith'</span><span>
</span><a name="line-399"></a><span class="hs-comment">--</span><span>
</span><a name="line-400"></a><span class="hs-comment">--  * does not exit the `Eval` monad</span><span>
</span><a name="line-401"></a><span class="hs-comment">--</span><span>
</span><a name="line-402"></a><span class="hs-comment">--  * does not have a built-in `rseq`, so for example `rparWith r0`</span><span>
</span><a name="line-403"></a><span class="hs-comment">--    behaves as you might expect (it is a strategy that creates a</span><span>
</span><a name="line-404"></a><span class="hs-comment">--    spark that does no evaluation).</span><span>
</span><a name="line-405"></a><span class="hs-comment">--</span><span>
</span><a name="line-406"></a><span class="hs-comment">--</span><span>
</span><a name="line-407"></a><span class="hs-identifier">rparWith</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414114"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414114"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-408"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 702</span><span>
</span><a name="line-409"></a><a name="rparWith"><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier">rparWith</span></a></a><span> </span><a name="local-1627414138"><a href="#local-1627414138"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-1627414139"><a href="#local-1627414139"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-1627414143"><a href="#local-1627414143"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Control.Parallel.Strategies.html#rpar"><span class="hs-identifier hs-var">rpar</span></a><span> </span><a href="#local-1627414140"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><a href="#local-1627414143"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">of</span><span> </span><a href="Control.Parallel.Strategies.html#Lift"><span class="hs-identifier hs-var">Lift</span></a><span> </span><a name="local-1627414144"><a href="#local-1627414144"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627414144"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-410"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-1627414140"><a href="#local-1627414140"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627414138"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-1627414139"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-411"></a><span>              </span><a href="Control.Parallel.Strategies.html#Eval"><span class="hs-identifier hs-var">Eval</span></a><span> </span><a name="local-1627414141"><a href="#local-1627414141"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627414141"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier hs-var">realWorld</span><span class="hs-operator hs-var">#</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-412"></a><span>                          </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627414142"><a href="#local-1627414142"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Lift"><span class="hs-identifier hs-var">Lift</span></a><span> </span><a href="#local-1627414142"><span class="hs-identifier hs-var">a'</span></a><span>
</span><a name="line-413"></a><span>
</span><a name="line-414"></a><span class="hs-keyword">data</span><span> </span><a name="Lift"><a href="Control.Parallel.Strategies.html#Lift"><span class="hs-identifier">Lift</span></a></a><span> </span><a name="local-1627413490"><a href="#local-1627413490"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Lift"><a href="Control.Parallel.Strategies.html#Lift"><span class="hs-identifier">Lift</span></a></a><span> </span><a href="#local-1627413490"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-415"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-416"></a><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">rpar</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">Done</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><a name="line-417"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-418"></a><span>
</span><a name="line-419"></a><span class="hs-comment">-- --------------------------------------------------------------------------</span><span>
</span><a name="line-420"></a><span class="hs-comment">-- Strategy combinators for Traversable data types</span><span>
</span><a name="line-421"></a><span>
</span><a name="line-422"></a><span class="hs-comment">-- | Evaluate the elements of a traversable data structure</span><span>
</span><a name="line-423"></a><span class="hs-comment">-- according to the given strategy.</span><span>
</span><a name="line-424"></a><span class="hs-identifier">evalTraversable</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Traversable</span><span> </span><a href="#local-1627414112"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414113"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627414112"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-1627414113"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-425"></a><a name="evalTraversable"><a href="Control.Parallel.Strategies.html#evalTraversable"><span class="hs-identifier">evalTraversable</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">traverse</span><span>
</span><a name="line-426"></a><span class="hs-pragma">{-# INLINE evalTraversable #-}</span><span>
</span><a name="line-427"></a><span>
</span><a name="line-428"></a><span class="hs-comment">-- | Like 'evalTraversable' but evaluates all elements in parallel.</span><span>
</span><a name="line-429"></a><span class="hs-identifier">parTraversable</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Traversable</span><span> </span><a href="#local-1627414110"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414111"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627414110"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-1627414111"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-430"></a><a name="parTraversable"><a href="Control.Parallel.Strategies.html#parTraversable"><span class="hs-identifier">parTraversable</span></a></a><span> </span><a name="local-1627414145"><a href="#local-1627414145"><span class="hs-identifier">strat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Parallel.Strategies.html#evalTraversable"><span class="hs-identifier hs-var">evalTraversable</span></a><span> </span><span class="hs-special">(</span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">rparWith</span></a><span> </span><a href="#local-1627414145"><span class="hs-identifier hs-var">strat</span></a><span class="hs-special">)</span><span>
</span><a name="line-431"></a><span class="hs-pragma">{-# INLINE parTraversable #-}</span><span>
</span><a name="line-432"></a><span>
</span><a name="line-433"></a><span class="hs-comment">-- --------------------------------------------------------------------------</span><span>
</span><a name="line-434"></a><span class="hs-comment">-- Strategies for lists</span><span>
</span><a name="line-435"></a><span>
</span><a name="line-436"></a><span class="hs-comment">-- | Evaluate each element of a list according to the given strategy.</span><span>
</span><a name="line-437"></a><span class="hs-comment">--  Equivalent to 'evalTraversable' at the list type.</span><span>
</span><a name="line-438"></a><span class="hs-identifier">evalList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414109"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627414109"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-439"></a><a name="evalList"><a href="Control.Parallel.Strategies.html#evalList"><span class="hs-identifier">evalList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Parallel.Strategies.html#evalTraversable"><span class="hs-identifier hs-var">evalTraversable</span></a><span>
</span><a name="line-440"></a><span class="hs-comment">-- Alternative explicitly recursive definition:</span><span>
</span><a name="line-441"></a><span class="hs-comment">-- evalList strat []     = return []</span><span>
</span><a name="line-442"></a><span class="hs-comment">-- evalList strat (x:xs) = strat x &gt;&gt;= \x' -&gt;</span><span>
</span><a name="line-443"></a><span class="hs-comment">--                         evalList strat xs &gt;&gt;= \xs' -&gt;</span><span>
</span><a name="line-444"></a><span class="hs-comment">--                         return (x':xs')</span><span>
</span><a name="line-445"></a><span>
</span><a name="line-446"></a><span class="hs-comment">-- | Evaluate each element of a list in parallel according to given strategy.</span><span>
</span><a name="line-447"></a><span class="hs-comment">--  Equivalent to 'parTraversable' at the list type.</span><span>
</span><a name="line-448"></a><span class="hs-identifier">parList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414108"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627414108"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-449"></a><a name="parList"><a href="Control.Parallel.Strategies.html#parList"><span class="hs-identifier">parList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Parallel.Strategies.html#parTraversable"><span class="hs-identifier hs-var">parTraversable</span></a><span>
</span><a name="line-450"></a><span class="hs-comment">-- Alternative definition via evalList:</span><span>
</span><a name="line-451"></a><span class="hs-comment">-- parList strat = evalList (rparWith strat)</span><span>
</span><a name="line-452"></a><span>
</span><a name="line-453"></a><span class="hs-comment">-- | @'evaListSplitAt' n stratPref stratSuff@ evaluates the prefix</span><span>
</span><a name="line-454"></a><span class="hs-comment">-- (of length @n@) of a list according to @stratPref@ and its the suffix</span><span>
</span><a name="line-455"></a><span class="hs-comment">-- according to @stratSuff@.</span><span>
</span><a name="line-456"></a><span class="hs-identifier">evalListSplitAt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627414107"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627414107"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627414107"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-457"></a><a name="evalListSplitAt"><a href="Control.Parallel.Strategies.html#evalListSplitAt"><span class="hs-identifier">evalListSplitAt</span></a></a><span> </span><a name="local-1627414146"><a href="#local-1627414146"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627414147"><a href="#local-1627414147"><span class="hs-identifier">stratPref</span></a></a><span> </span><a name="local-1627414148"><a href="#local-1627414148"><span class="hs-identifier">stratSuff</span></a></a><span> </span><a name="local-1627414149"><a href="#local-1627414149"><span class="hs-identifier">xs</span></a></a><span>
</span><a name="line-458"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1627414150"><a href="#local-1627414150"><span class="hs-identifier">ys</span></a></a><span class="hs-special">,</span><a name="local-1627414151"><a href="#local-1627414151"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">splitAt</span><span> </span><a href="#local-1627414146"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627414149"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-459"></a><span>    </span><a href="#local-1627414147"><span class="hs-identifier hs-var">stratPref</span></a><span> </span><a href="#local-1627414150"><span class="hs-identifier hs-var">ys</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-1627414345"><a href="#local-1627414345"><span class="hs-identifier">ys'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-460"></a><span>    </span><a href="#local-1627414148"><span class="hs-identifier hs-var">stratSuff</span></a><span> </span><a href="#local-1627414151"><span class="hs-identifier hs-var">zs</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-1627414346"><a href="#local-1627414346"><span class="hs-identifier">zs'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-461"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-1627414345"><span class="hs-identifier hs-var">ys'</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-1627414346"><span class="hs-identifier hs-var">zs'</span></a><span class="hs-special">)</span><span>
</span><a name="line-462"></a><span>
</span><a name="line-463"></a><span class="hs-comment">-- | Like 'evalListSplitAt' but evaluates both sublists in parallel.</span><span>
</span><a name="line-464"></a><span class="hs-identifier">parListSplitAt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627414106"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627414106"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627414106"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-465"></a><a name="parListSplitAt"><a href="Control.Parallel.Strategies.html#parListSplitAt"><span class="hs-identifier">parListSplitAt</span></a></a><span> </span><a name="local-1627414347"><a href="#local-1627414347"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627414348"><a href="#local-1627414348"><span class="hs-identifier">stratPref</span></a></a><span> </span><a name="local-1627414349"><a href="#local-1627414349"><span class="hs-identifier">stratSuff</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Parallel.Strategies.html#evalListSplitAt"><span class="hs-identifier hs-var">evalListSplitAt</span></a><span> </span><a href="#local-1627414347"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">rparWith</span></a><span> </span><a href="#local-1627414348"><span class="hs-identifier hs-var">stratPref</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">rparWith</span></a><span> </span><a href="#local-1627414349"><span class="hs-identifier hs-var">stratSuff</span></a><span class="hs-special">)</span><span>
</span><a name="line-466"></a><span>
</span><a name="line-467"></a><span class="hs-comment">-- | Evaluate the first n elements of a list according to the given strategy.</span><span>
</span><a name="line-468"></a><span class="hs-identifier">evalListN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414105"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627414105"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-469"></a><a name="evalListN"><a href="Control.Parallel.Strategies.html#evalListN"><span class="hs-identifier">evalListN</span></a></a><span> </span><a name="local-1627414350"><a href="#local-1627414350"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627414351"><a href="#local-1627414351"><span class="hs-identifier">strat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Parallel.Strategies.html#evalListSplitAt"><span class="hs-identifier hs-var">evalListSplitAt</span></a><span> </span><a href="#local-1627414350"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="Control.Parallel.Strategies.html#evalList"><span class="hs-identifier hs-var">evalList</span></a><span> </span><a href="#local-1627414351"><span class="hs-identifier hs-var">strat</span></a><span class="hs-special">)</span><span> </span><a href="Control.Parallel.Strategies.html#r0"><span class="hs-identifier hs-var">r0</span></a><span>
</span><a name="line-470"></a><span>
</span><a name="line-471"></a><span class="hs-comment">-- | Like 'evalListN' but evaluates the first n elements in parallel.</span><span>
</span><a name="line-472"></a><span class="hs-identifier">parListN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414104"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627414104"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-473"></a><a name="parListN"><a href="Control.Parallel.Strategies.html#parListN"><span class="hs-identifier">parListN</span></a></a><span> </span><a name="local-1627414352"><a href="#local-1627414352"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627414353"><a href="#local-1627414353"><span class="hs-identifier">strat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Parallel.Strategies.html#evalListN"><span class="hs-identifier hs-var">evalListN</span></a><span> </span><a href="#local-1627414352"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">rparWith</span></a><span> </span><a href="#local-1627414353"><span class="hs-identifier hs-var">strat</span></a><span class="hs-special">)</span><span>
</span><a name="line-474"></a><span>
</span><a name="line-475"></a><span class="hs-comment">-- | Evaluate the nth element of a list (if there is such) according to</span><span>
</span><a name="line-476"></a><span class="hs-comment">-- the given strategy.</span><span>
</span><a name="line-477"></a><span class="hs-comment">-- The spine of the list up to the nth element is evaluated as a side effect.</span><span>
</span><a name="line-478"></a><span class="hs-identifier">evalListNth</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414103"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627414103"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-479"></a><a name="evalListNth"><a href="Control.Parallel.Strategies.html#evalListNth"><span class="hs-identifier">evalListNth</span></a></a><span> </span><a name="local-1627414354"><a href="#local-1627414354"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627414355"><a href="#local-1627414355"><span class="hs-identifier">strat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Parallel.Strategies.html#evalListSplitAt"><span class="hs-identifier hs-var">evalListSplitAt</span></a><span> </span><a href="#local-1627414354"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="Control.Parallel.Strategies.html#r0"><span class="hs-identifier hs-var">r0</span></a><span> </span><span class="hs-special">(</span><a href="Control.Parallel.Strategies.html#evalListN"><span class="hs-identifier hs-var">evalListN</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="#local-1627414355"><span class="hs-identifier hs-var">strat</span></a><span class="hs-special">)</span><span>
</span><a name="line-480"></a><span>
</span><a name="line-481"></a><span class="hs-comment">-- | Like 'evalListN' but evaluates the nth element in parallel.</span><span>
</span><a name="line-482"></a><span class="hs-identifier">parListNth</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414102"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627414102"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-483"></a><a name="parListNth"><a href="Control.Parallel.Strategies.html#parListNth"><span class="hs-identifier">parListNth</span></a></a><span> </span><a name="local-1627414356"><a href="#local-1627414356"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627414357"><a href="#local-1627414357"><span class="hs-identifier">strat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Parallel.Strategies.html#evalListNth"><span class="hs-identifier hs-var">evalListNth</span></a><span> </span><a href="#local-1627414356"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">rparWith</span></a><span> </span><a href="#local-1627414357"><span class="hs-identifier hs-var">strat</span></a><span class="hs-special">)</span><span>
</span><a name="line-484"></a><span>
</span><a name="line-485"></a><span class="hs-comment">-- | Divides a list into chunks, and applies the strategy</span><span>
</span><a name="line-486"></a><span class="hs-comment">-- @'evalList' strat@ to each chunk in parallel.</span><span>
</span><a name="line-487"></a><span class="hs-comment">--</span><span>
</span><a name="line-488"></a><span class="hs-comment">-- It is expected that this function will be replaced by a more</span><span>
</span><a name="line-489"></a><span class="hs-comment">-- generic clustering infrastructure in the future.</span><span>
</span><a name="line-490"></a><span class="hs-comment">--</span><span>
</span><a name="line-491"></a><span class="hs-comment">-- If the chunk size is 1 or less, 'parListChunk' is equivalent to</span><span>
</span><a name="line-492"></a><span class="hs-comment">-- 'parList'</span><span>
</span><a name="line-493"></a><span class="hs-comment">--</span><span>
</span><a name="line-494"></a><span class="hs-identifier">parListChunk</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><a href="#local-1627414101"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627414101"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-495"></a><a name="parListChunk"><a href="Control.Parallel.Strategies.html#parListChunk"><span class="hs-identifier">parListChunk</span></a></a><span> </span><a name="local-1627414358"><a href="#local-1627414358"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627414359"><a href="#local-1627414359"><span class="hs-identifier">strat</span></a></a><span> </span><a name="local-1627414360"><a href="#local-1627414360"><span class="hs-identifier">xs</span></a></a><span>
</span><a name="line-496"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627414358"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">1</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Control.Parallel.Strategies.html#parList"><span class="hs-identifier hs-var">parList</span></a><span> </span><a href="#local-1627414359"><span class="hs-identifier hs-var">strat</span></a><span> </span><a href="#local-1627414360"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-497"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">fmap</span><span class="hs-special">`</span><span> </span><a href="Control.Parallel.Strategies.html#parList"><span class="hs-identifier hs-var">parList</span></a><span> </span><span class="hs-special">(</span><a href="Control.Parallel.Strategies.html#evalList"><span class="hs-identifier hs-var">evalList</span></a><span> </span><a href="#local-1627414359"><span class="hs-identifier hs-var">strat</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Control.Parallel.Strategies.html#chunk"><span class="hs-identifier hs-var">chunk</span></a><span> </span><a href="#local-1627414358"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627414360"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-498"></a><span>
</span><a name="line-499"></a><span class="hs-identifier">chunk</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627414100"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-1627414100"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-500"></a><a name="chunk"><a href="Control.Parallel.Strategies.html#chunk"><span class="hs-identifier">chunk</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-501"></a><span class="hs-identifier">chunk</span><span> </span><a name="local-1627414361"><a href="#local-1627414361"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627414362"><a href="#local-1627414362"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Control.Parallel.Strategies.html#chunk"><span class="hs-identifier hs-var">chunk</span></a><span> </span><a href="#local-1627414361"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627414364"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">as</span><span class="hs-special">,</span><a name="local-1627414364"><a href="#local-1627414364"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">splitAt</span><span> </span><a href="#local-1627414361"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627414362"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-502"></a><span>
</span><a name="line-503"></a><span class="hs-comment">-- Non-compositional version of 'parList', evaluating list elements</span><span>
</span><a name="line-504"></a><span class="hs-comment">-- to weak head normal form.</span><span>
</span><a name="line-505"></a><span class="hs-comment">-- Not to be exported; used for optimisation.</span><span>
</span><a name="line-506"></a><span>
</span><a name="line-507"></a><span class="hs-comment">-- | DEPRECATED: use @'parList' 'rseq'@ instead</span><span>
</span><a name="line-508"></a><span class="hs-identifier">parListWHNF</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">Strategy</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627414099"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-509"></a><a name="parListWHNF"><a href="Control.Parallel.Strategies.html#parListWHNF"><span class="hs-identifier">parListWHNF</span></a></a><span> </span><a name="local-1627414365"><a href="#local-1627414365"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627414366"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627414365"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">`</span><a href="Control.Parallel.html#pseq"><span class="hs-identifier hs-var">pseq</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-1627414365"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-510"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-comment">-- go :: [a] -&gt; [a]</span><span>
</span><a name="line-511"></a><span>           </span><a name="local-1627414366"><a href="#local-1627414366"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-512"></a><span>           </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a name="local-1627414367"><a href="#local-1627414367"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-1627414368"><a href="#local-1627414368"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627414367"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="Control.Parallel.html#par"><span class="hs-identifier hs-var">par</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627414366"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627414368"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-513"></a><span>
</span><a name="line-514"></a><span class="hs-comment">-- The non-compositional 'parListWHNF' might be more efficient than its</span><span>
</span><a name="line-515"></a><span class="hs-comment">-- more compositional counterpart; use RULES to do the specialisation.</span><span>
</span><a name="line-516"></a><span>
</span><a name="line-517"></a><span class="hs-pragma">{-# NOINLINE [1] parList #-}</span><span>
</span><a name="line-518"></a><span class="hs-pragma">{-# NOINLINE [1] rseq #-}</span><span>
</span><a name="line-519"></a><span class="hs-pragma">{-# RULES
 &quot;parList/rseq&quot; parList rseq = parListWHNF
 #-}</span><span>
</span><a name="line-522"></a><span>
</span><a name="line-523"></a><span class="hs-comment">-- --------------------------------------------------------------------------</span><span>
</span><a name="line-524"></a><span class="hs-comment">-- Convenience</span><span>
</span><a name="line-525"></a><span>
</span><a name="line-526"></a><span class="hs-comment">-- | A combination of 'parList' and 'map', encapsulating a common pattern:</span><span>
</span><a name="line-527"></a><span class="hs-comment">--</span><span>
</span><a name="line-528"></a><span class="hs-comment">-- &gt; parMap strat f = withStrategy (parList strat) . map f</span><span>
</span><a name="line-529"></a><span class="hs-comment">--</span><span>
</span><a name="line-530"></a><span class="hs-identifier">parMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">b</span><span class="hs-special">]</span><span>
</span><a name="line-531"></a><span class="hs-identifier">parMap</span><span> </span><span class="hs-identifier">strat</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier">using</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">parList</span><span> </span><span class="hs-identifier">strat</span><span class="hs-special">)</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">f</span><span>
</span><a name="line-532"></a><span>
</span><a name="line-533"></a><span class="hs-comment">-- --------------------------------------------------------------------------</span><span>
</span><a name="line-534"></a><span class="hs-comment">-- Strategies for lazy lists</span><span>
</span><a name="line-535"></a><span>
</span><a name="line-536"></a><span class="hs-comment">-- List-based non-compositional rolling buffer strategy, evaluating list</span><span>
</span><a name="line-537"></a><span class="hs-comment">-- elements to weak head normal form.</span><span>
</span><a name="line-538"></a><span class="hs-comment">-- Not to be exported; used in evalBuffer and for optimisation.</span><span>
</span><a name="line-539"></a><span class="hs-identifier">evalBufferWHNF</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-540"></a><span class="hs-identifier">evalBufferWHNF</span><span> </span><span class="hs-identifier">n0</span><span> </span><span class="hs-identifier hs-type">xs0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ret</span><span> </span><span class="hs-identifier">xs0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">start</span><span> </span><span class="hs-identifier">n0</span><span> </span><span class="hs-identifier">xs0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-541"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-comment">-- ret :: [a] -&gt; [a] -&gt; [a]</span><span>
</span><a name="line-542"></a><span>           </span><span class="hs-identifier">ret</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">y</span><span class="hs-glyph">:</span><span class="hs-identifier">ys</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">pseq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">ret</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-identifier">ys</span><span class="hs-special">)</span><span>
</span><a name="line-543"></a><span>           </span><a name="local-1627414373"><a href="#local-1627414373"><span class="hs-identifier">ret</span></a></a><span> </span><span class="hs-identifier">xs</span><span>     </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-544"></a><span>
</span><a name="line-545"></a><span>        </span><span class="hs-comment">-- start :: Int -&gt; [a] -&gt; [a]</span><span>
</span><a name="line-546"></a><span>           </span><span class="hs-identifier">start</span><span> </span><span class="hs-number">0</span><span>   </span><span class="hs-identifier">ys</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ys</span><span>
</span><a name="line-547"></a><span>           </span><a name="local-1627414374"><a href="#local-1627414374"><span class="hs-identifier">start</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_n</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-548"></a><span>           </span><span class="hs-identifier">start</span><span> </span><span class="hs-glyph">!</span><a name="local-1627414381"><a href="#local-1627414381"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">y</span><span class="hs-glyph">:</span><span class="hs-identifier">ys</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">pseq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">start</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ys</span><span>
</span><a name="line-549"></a><span>
</span><a name="line-550"></a><span class="hs-comment">-- | 'evalBuffer' is a rolling buffer strategy combinator for (lazy) lists.</span><span>
</span><a name="line-551"></a><span class="hs-comment">--</span><span>
</span><a name="line-552"></a><span class="hs-comment">-- 'evalBuffer' is not as compositional as the type suggests. In fact,</span><span>
</span><a name="line-553"></a><span class="hs-comment">-- it evaluates list elements at least to weak head normal form,</span><span>
</span><a name="line-554"></a><span class="hs-comment">-- disregarding a strategy argument 'r0'.</span><span>
</span><a name="line-555"></a><span class="hs-comment">--</span><span>
</span><a name="line-556"></a><span class="hs-comment">-- &gt; evalBuffer n r0 == evalBuffer n rseq</span><span>
</span><a name="line-557"></a><span class="hs-comment">--</span><span>
</span><a name="line-558"></a><span class="hs-identifier">evalBuffer</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-559"></a><span class="hs-identifier">evalBuffer</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">strat</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">evalBufferWHNF</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">.</span></a><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">withStrategy</span><span> </span><span class="hs-identifier">strat</span><span class="hs-special">)</span><span>
</span><a name="line-560"></a><span>
</span><a name="line-561"></a><span class="hs-comment">-- Like evalBufferWHNF but sparks the list elements when pushing them</span><span>
</span><a name="line-562"></a><span class="hs-comment">-- into the buffer.</span><span>
</span><a name="line-563"></a><span class="hs-comment">-- Not to be exported; used in parBuffer and for optimisation.</span><span>
</span><a name="line-564"></a><span class="hs-identifier">parBufferWHNF</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-565"></a><span class="hs-identifier">parBufferWHNF</span><span> </span><span class="hs-identifier">n0</span><span> </span><span class="hs-identifier hs-type">xs0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ret</span><span> </span><span class="hs-identifier">xs0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">start</span><span> </span><span class="hs-identifier">n0</span><span> </span><span class="hs-identifier">xs0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-566"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-comment">-- ret :: [a] -&gt; [a] -&gt; [a]</span><span>
</span><a name="line-567"></a><span>           </span><span class="hs-identifier">ret</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">y</span><span class="hs-glyph">:</span><span class="hs-identifier">ys</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">par</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">ret</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-identifier">ys</span><span class="hs-special">)</span><span>
</span><a name="line-568"></a><span>           </span><a name="local-1627414389"><a href="#local-1627414389"><span class="hs-identifier">ret</span></a></a><span> </span><span class="hs-identifier">xs</span><span>     </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-569"></a><span>
</span><a name="line-570"></a><span>        </span><span class="hs-comment">-- start :: Int -&gt; [a] -&gt; [a]</span><span>
</span><a name="line-571"></a><span>           </span><span class="hs-identifier">start</span><span> </span><span class="hs-number">0</span><span>   </span><span class="hs-identifier">ys</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ys</span><span>
</span><a name="line-572"></a><span>           </span><a name="local-1627414390"><a href="#local-1627414390"><span class="hs-identifier">start</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_n</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-573"></a><span>           </span><span class="hs-identifier">start</span><span> </span><span class="hs-glyph">!</span><a name="local-1627414397"><a href="#local-1627414397"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">y</span><span class="hs-glyph">:</span><span class="hs-identifier">ys</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">par</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">start</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ys</span><span>
</span><a name="line-574"></a><span>
</span><a name="line-575"></a><span>
</span><a name="line-576"></a><span class="hs-comment">-- | Like 'evalBuffer' but evaluates the list elements in parallel when</span><span>
</span><a name="line-577"></a><span class="hs-comment">-- pushing them into the buffer.</span><span>
</span><a name="line-578"></a><span class="hs-identifier">parBuffer</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-579"></a><span class="hs-identifier">parBuffer</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">strat</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">parBufferWHNF</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">.</span></a><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">map</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">withStrategy</span><span> </span><span class="hs-identifier">strat</span><span class="hs-special">)</span><span>
</span><a name="line-580"></a><span class="hs-comment">-- Alternative definition via evalBuffer (may compromise firing of RULES):</span><span>
</span><a name="line-581"></a><span class="hs-comment">-- parBuffer n strat = evalBuffer n (rparWith strat)</span><span>
</span><a name="line-582"></a><span>
</span><a name="line-583"></a><span class="hs-comment">-- Deforest the intermediate list in parBuffer/evalBuffer when it is</span><span>
</span><a name="line-584"></a><span class="hs-comment">-- unnecessary:</span><span>
</span><a name="line-585"></a><span>
</span><a name="line-586"></a><span class="hs-pragma">{-# NOINLINE [1] evalBuffer #-}</span><span>
</span><a name="line-587"></a><span class="hs-pragma">{-# NOINLINE [1] parBuffer #-}</span><span>
</span><a name="line-588"></a><span class="hs-pragma">{-# RULES
&quot;evalBuffer/rseq&quot;  forall n . evalBuffer  n rseq = evalBufferWHNF n
&quot;parBuffer/rseq&quot;   forall n . parBuffer   n rseq = parBufferWHNF  n
 #-}</span><span>
</span><a name="line-592"></a><span>
</span><a name="line-593"></a><span class="hs-comment">-- --------------------------------------------------------------------------</span><span>
</span><a name="line-594"></a><span class="hs-comment">-- Strategies for tuples</span><span>
</span><a name="line-595"></a><span>
</span><a name="line-596"></a><span class="hs-identifier">evalTuple2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-597"></a><span class="hs-identifier">evalTuple2</span><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-598"></a><span>  </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">strat1</span></a><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">strat2</span></a><span> </span><span class="hs-identifier">x2</span><span>
</span><a name="line-599"></a><span>
</span><a name="line-600"></a><span class="hs-identifier">evalTuple3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414405"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414406"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-601"></a><span class="hs-identifier">evalTuple3</span><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-identifier">strat3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span class="hs-identifier">x2</span><span class="hs-special">,</span><span class="hs-identifier">x3</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-602"></a><span>  </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">strat1</span></a><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">strat2</span></a><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">strat3</span></a><span> </span><span class="hs-identifier">x3</span><span>
</span><a name="line-603"></a><span>
</span><a name="line-604"></a><span class="hs-identifier">evalTuple4</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414410"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414411"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414412"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-605"></a><span class="hs-identifier">evalTuple4</span><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-identifier">strat3</span><span> </span><span class="hs-identifier">strat4</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span class="hs-identifier">x2</span><span class="hs-special">,</span><span class="hs-identifier">x3</span><span class="hs-special">,</span><span class="hs-identifier">x4</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-606"></a><span>  </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">strat3</span><span> </span><span class="hs-identifier">x3</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">strat4</span><span> </span><span class="hs-identifier">x4</span><span>
</span><a name="line-607"></a><span>
</span><a name="line-608"></a><span class="hs-identifier">evalTuple5</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">d</span><span class="hs-special">,</span><span class="hs-identifier">e</span><span class="hs-special">)</span><span>
</span><a name="line-609"></a><span class="hs-identifier">evalTuple5</span><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-identifier">strat3</span><span> </span><span class="hs-identifier">strat4</span><span> </span><span class="hs-identifier">strat5</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span class="hs-identifier">x2</span><span class="hs-special">,</span><span class="hs-identifier">x3</span><span class="hs-special">,</span><span class="hs-identifier">x4</span><span class="hs-special">,</span><span class="hs-identifier">x5</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-610"></a><span>  </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">x1</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-identifier">x2</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat3</span><span> </span><span class="hs-identifier">x3</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat4</span><span> </span><span class="hs-identifier">x4</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat5</span><span> </span><span class="hs-identifier">x5</span><span>
</span><a name="line-611"></a><span>
</span><a name="line-612"></a><span class="hs-identifier">evalTuple6</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414421"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414422"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414423"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414424"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414425"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">d</span><span class="hs-special">,</span><span class="hs-identifier">e</span><span class="hs-special">,</span><span class="hs-identifier">f</span><span class="hs-special">)</span><span>
</span><a name="line-613"></a><span class="hs-identifier">evalTuple6</span><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-identifier">strat3</span><span> </span><span class="hs-identifier">strat4</span><span> </span><span class="hs-identifier">strat5</span><span> </span><span class="hs-identifier">strat6</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span class="hs-identifier">x2</span><span class="hs-special">,</span><span class="hs-identifier">x3</span><span class="hs-special">,</span><span class="hs-identifier">x4</span><span class="hs-special">,</span><span class="hs-identifier">x5</span><span class="hs-special">,</span><span class="hs-identifier">x6</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-614"></a><span>  </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">x1</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-identifier">x2</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat3</span><span> </span><span class="hs-identifier">x3</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat4</span><span> </span><span class="hs-identifier">x4</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat5</span><span> </span><span class="hs-identifier">x5</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat6</span><span> </span><span class="hs-identifier">x6</span><span>
</span><a name="line-615"></a><span>
</span><a name="line-616"></a><span class="hs-identifier">evalTuple7</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414431"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414432"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414433"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414434"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414435"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414436"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">d</span><span class="hs-special">,</span><span class="hs-identifier">e</span><span class="hs-special">,</span><span class="hs-identifier">f</span><span class="hs-special">,</span><span class="hs-identifier">g</span><span class="hs-special">)</span><span>
</span><a name="line-617"></a><span class="hs-identifier">evalTuple7</span><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-identifier">strat3</span><span> </span><span class="hs-identifier">strat4</span><span> </span><span class="hs-identifier">strat5</span><span> </span><span class="hs-identifier">strat6</span><span> </span><span class="hs-identifier">strat7</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span class="hs-identifier">x2</span><span class="hs-special">,</span><span class="hs-identifier">x3</span><span class="hs-special">,</span><span class="hs-identifier">x4</span><span class="hs-special">,</span><span class="hs-identifier">x5</span><span class="hs-special">,</span><span class="hs-identifier">x6</span><span class="hs-special">,</span><span class="hs-identifier">x7</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-618"></a><span>  </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">x1</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-identifier">x2</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat3</span><span> </span><span class="hs-identifier">x3</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat4</span><span> </span><span class="hs-identifier">x4</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat5</span><span> </span><span class="hs-identifier">x5</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat6</span><span> </span><span class="hs-identifier">x6</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat7</span><span> </span><span class="hs-identifier">x7</span><span>
</span><a name="line-619"></a><span>
</span><a name="line-620"></a><span class="hs-identifier">evalTuple8</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414443"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414444"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414445"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414446"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414447"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414448"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414449"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">h</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">d</span><span class="hs-special">,</span><span class="hs-identifier">e</span><span class="hs-special">,</span><span class="hs-identifier">f</span><span class="hs-special">,</span><span class="hs-identifier">g</span><span class="hs-special">,</span><span class="hs-identifier">h</span><span class="hs-special">)</span><span>
</span><a name="line-621"></a><span class="hs-identifier">evalTuple8</span><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-identifier">strat3</span><span> </span><span class="hs-identifier">strat4</span><span> </span><span class="hs-identifier">strat5</span><span> </span><span class="hs-identifier">strat6</span><span> </span><span class="hs-identifier">strat7</span><span> </span><span class="hs-identifier">strat8</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span class="hs-identifier">x2</span><span class="hs-special">,</span><span class="hs-identifier">x3</span><span class="hs-special">,</span><span class="hs-identifier">x4</span><span class="hs-special">,</span><span class="hs-identifier">x5</span><span class="hs-special">,</span><span class="hs-identifier">x6</span><span class="hs-special">,</span><span class="hs-identifier">x7</span><span class="hs-special">,</span><span class="hs-identifier">x8</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-622"></a><span>  </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat1</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">x1</span></a><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat2</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">x2</span></a><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat3</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">x3</span></a><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat4</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">x4</span></a><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat5</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">x5</span></a><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat6</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">x6</span></a><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat7</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">x7</span></a><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat8</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">x8</span></a><span>
</span><a name="line-623"></a><span>
</span><a name="line-624"></a><span class="hs-identifier">evalTuple9</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414457"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414458"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414459"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414460"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414461"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414462"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414463"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414464"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">d</span><span class="hs-special">,</span><span class="hs-identifier">e</span><span class="hs-special">,</span><span class="hs-identifier">f</span><span class="hs-special">,</span><span class="hs-identifier">g</span><span class="hs-special">,</span><span class="hs-identifier">h</span><span class="hs-special">,</span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><a name="line-625"></a><span class="hs-identifier">evalTuple9</span><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-identifier">strat3</span><span> </span><span class="hs-identifier">strat4</span><span> </span><span class="hs-identifier">strat5</span><span> </span><span class="hs-identifier">strat6</span><span> </span><span class="hs-identifier">strat7</span><span> </span><span class="hs-identifier">strat8</span><span> </span><span class="hs-identifier">strat9</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span class="hs-identifier">x2</span><span class="hs-special">,</span><span class="hs-identifier">x3</span><span class="hs-special">,</span><span class="hs-identifier">x4</span><span class="hs-special">,</span><span class="hs-identifier">x5</span><span class="hs-special">,</span><span class="hs-identifier">x6</span><span class="hs-special">,</span><span class="hs-identifier">x7</span><span class="hs-special">,</span><span class="hs-identifier">x8</span><span class="hs-special">,</span><span class="hs-identifier">x9</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-626"></a><span>  </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat1</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">x1</span></a><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat2</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">x2</span></a><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat3</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">x3</span></a><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat4</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">x4</span></a><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat5</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">x5</span></a><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat6</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">x6</span></a><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat7</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">x7</span></a><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat8</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">x8</span></a><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-operator hs-type">&lt;*&gt;</span></a><span> </span><span class="hs-identifier">strat9</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">x9</span></a><span>
</span><a name="line-627"></a><span>
</span><a name="line-628"></a><span class="hs-identifier">parTuple2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414473"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414474"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><a href="#local-1627414475"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-1627414475"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-629"></a><span class="hs-identifier">parTuple2</span><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-630"></a><span>  </span><span class="hs-identifier">evalTuple2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">strat2</span></a><span class="hs-special">)</span><span>
</span><a name="line-631"></a><span>
</span><a name="line-632"></a><span class="hs-identifier">parTuple3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-633"></a><span class="hs-identifier">parTuple3</span><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-identifier">strat3</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-634"></a><span>  </span><span class="hs-identifier">evalTuple3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">strat2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat3</span><span class="hs-special">)</span><span>
</span><a name="line-635"></a><span>
</span><a name="line-636"></a><span class="hs-identifier">parTuple4</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414495"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-637"></a><span class="hs-identifier">parTuple4</span><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-identifier">strat3</span><span> </span><span class="hs-identifier">strat4</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-638"></a><span>  </span><span class="hs-identifier">evalTuple4</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">strat2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat3</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat4</span><span class="hs-special">)</span><span>
</span><a name="line-639"></a><span>
</span><a name="line-640"></a><span class="hs-identifier">parTuple5</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414498"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414499"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">d</span><span class="hs-special">,</span><span class="hs-identifier">e</span><span class="hs-special">)</span><span>
</span><a name="line-641"></a><span class="hs-identifier">parTuple5</span><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-identifier">strat3</span><span> </span><span class="hs-identifier">strat4</span><span> </span><span class="hs-identifier">strat5</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-642"></a><span>  </span><span class="hs-identifier">evalTuple5</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">strat2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat3</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat4</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat5</span><span class="hs-special">)</span><span>
</span><a name="line-643"></a><span>
</span><a name="line-644"></a><span class="hs-identifier">parTuple6</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414502"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414503"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">d</span><span class="hs-special">,</span><span class="hs-identifier">e</span><span class="hs-special">,</span><span class="hs-identifier">f</span><span class="hs-special">)</span><span>
</span><a name="line-645"></a><span class="hs-identifier">parTuple6</span><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-identifier">strat3</span><span> </span><span class="hs-identifier">strat4</span><span> </span><span class="hs-identifier">strat5</span><span> </span><span class="hs-identifier">strat6</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-646"></a><span>  </span><span class="hs-identifier">evalTuple6</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">strat2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat3</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat4</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat5</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat6</span><span class="hs-special">)</span><span>
</span><a name="line-647"></a><span>
</span><a name="line-648"></a><span class="hs-identifier">parTuple7</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414507"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414508"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">d</span><span class="hs-special">,</span><span class="hs-identifier">e</span><span class="hs-special">,</span><span class="hs-identifier">f</span><span class="hs-special">,</span><span class="hs-identifier">g</span><span class="hs-special">)</span><span>
</span><a name="line-649"></a><span class="hs-identifier">parTuple7</span><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-identifier">strat3</span><span> </span><span class="hs-identifier">strat4</span><span> </span><span class="hs-identifier">strat5</span><span> </span><span class="hs-identifier">strat6</span><span> </span><span class="hs-identifier">strat7</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-650"></a><span>  </span><span class="hs-identifier">evalTuple7</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">strat2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat3</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat4</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat5</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">strat6</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat7</span><span class="hs-special">)</span><span>
</span><a name="line-651"></a><span>
</span><a name="line-652"></a><span class="hs-identifier">parTuple8</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414513"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414514"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">h</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><a href="#local-1627414517"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">d</span><span class="hs-special">,</span><span class="hs-identifier">e</span><span class="hs-special">,</span><span class="hs-identifier">f</span><span class="hs-special">,</span><span class="hs-identifier">g</span><span class="hs-special">,</span><span class="hs-identifier">h</span><span class="hs-special">)</span><span>
</span><a name="line-653"></a><span class="hs-identifier">parTuple8</span><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-identifier">strat3</span><span> </span><span class="hs-identifier">strat4</span><span> </span><span class="hs-identifier">strat5</span><span> </span><span class="hs-identifier">strat6</span><span> </span><span class="hs-identifier">strat7</span><span> </span><span class="hs-identifier">strat8</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-654"></a><span>  </span><span class="hs-identifier">evalTuple8</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">strat2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat3</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat4</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat5</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">strat6</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat7</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat8</span><span class="hs-special">)</span><span>
</span><a name="line-655"></a><span>
</span><a name="line-656"></a><span class="hs-identifier">parTuple9</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414520"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414521"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="Control.Parallel.Strategies.html#rparWith"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">h</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><a href="#local-1627414524"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><a href="#local-1627414525"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-1627414525"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><a href="#local-1627414525"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span class="hs-identifier">d</span><span class="hs-special">,</span><span class="hs-identifier">e</span><span class="hs-special">,</span><span class="hs-identifier">f</span><span class="hs-special">,</span><span class="hs-identifier">g</span><span class="hs-special">,</span><span class="hs-identifier">h</span><span class="hs-special">,</span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><a name="line-657"></a><span class="hs-identifier">parTuple9</span><span> </span><span class="hs-identifier">strat1</span><span> </span><span class="hs-identifier">strat2</span><span> </span><span class="hs-identifier">strat3</span><span> </span><span class="hs-identifier">strat4</span><span> </span><span class="hs-identifier">strat5</span><span> </span><span class="hs-identifier">strat6</span><span> </span><span class="hs-identifier">strat7</span><span> </span><span class="hs-identifier">strat8</span><span> </span><span class="hs-identifier">strat9</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-658"></a><span>  </span><span class="hs-identifier">evalTuple9</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">strat2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat3</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat4</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat5</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">strat6</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat7</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat8</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rparWith</span><span> </span><span class="hs-identifier">strat9</span><span class="hs-special">)</span><span>
</span><a name="line-659"></a><span>
</span><a name="line-660"></a><span class="hs-comment">-- --------------------------------------------------------------------------</span><span>
</span><a name="line-661"></a><span class="hs-comment">-- Strategic function application</span><span>
</span><a name="line-662"></a><span>
</span><a name="line-663"></a><span class="hs-comment">{-
These are very handy when writing pipeline parallelism asa sequence of
@$@, @$|@ and @$||@'s. There is no need of naming intermediate values
in this case. The separation of algorithm from strategy is achieved by
allowing strategies only as second arguments to @$|@ and @$||@.
-}</span><span>
</span><a name="line-669"></a><span>
</span><a name="line-670"></a><span class="hs-comment">-- | Sequential function application. The argument is evaluated using</span><span>
</span><a name="line-671"></a><span class="hs-comment">--   the given strategy before it is given to the function.</span><span>
</span><a name="line-672"></a><span class="hs-special">(</span><span class="hs-operator">$|</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-673"></a><span class="hs-identifier">f</span><span> </span><span class="hs-operator">$|</span><span> </span><span class="hs-identifier">s</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">using</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">pseq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-674"></a><span>
</span><a name="line-675"></a><span class="hs-comment">-- | Parallel function application. The argument is evaluated using</span><span>
</span><a name="line-676"></a><span class="hs-comment">-- the given strategy, in parallel with the function application.</span><span>
</span><a name="line-677"></a><span class="hs-special">(</span><span class="hs-operator">$||</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-678"></a><span class="hs-identifier">f</span><span> </span><span class="hs-operator">$||</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">using</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">par</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-679"></a><span>
</span><a name="line-680"></a><span class="hs-comment">-- | Sequential function composition. The result of</span><span>
</span><a name="line-681"></a><span class="hs-comment">-- the second function is evaluated using the given strategy,</span><span>
</span><a name="line-682"></a><span class="hs-comment">-- and then given to the first function.</span><span>
</span><a name="line-683"></a><span class="hs-special">(</span><span class="hs-operator">.|</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-684"></a><span class="hs-special">(</span><span class="hs-operator">.|</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">using</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-685"></a><span>                    </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">z</span></a><span> </span><span class="hs-special">`</span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">pseq</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627413998"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-686"></a><span>
</span><a name="line-687"></a><span class="hs-comment">-- | Parallel function composition. The result of the second</span><span>
</span><a name="line-688"></a><span class="hs-comment">-- function is evaluated using the given strategy,</span><span>
</span><a name="line-689"></a><span class="hs-comment">-- in parallel with the application of the first function.</span><span>
</span><a name="line-690"></a><span class="hs-special">(</span><span class="hs-operator">.||</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-691"></a><span class="hs-special">(</span><span class="hs-operator">.||</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">using</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-692"></a><span>                    </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">`</span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">par</span></a><span class="hs-special">`</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627413995"><span class="hs-identifier hs-type">z</span></a><span>
</span><a name="line-693"></a><span>
</span><a name="line-694"></a><span class="hs-comment">-- | Sequential inverse function composition,</span><span>
</span><a name="line-695"></a><span class="hs-comment">-- for those who read their programs from left to right.</span><span>
</span><a name="line-696"></a><span class="hs-comment">-- The result of the first function is evaluated using the</span><span>
</span><a name="line-697"></a><span class="hs-comment">-- given strategy, and then given to the second function.</span><span>
</span><a name="line-698"></a><span class="hs-special">(</span><span class="hs-operator">-|</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-699"></a><span class="hs-special">(</span><span class="hs-operator">-|</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">using</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-700"></a><span>                    </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">z</span></a><span> </span><span class="hs-special">`</span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">pseq</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627413993"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-701"></a><span>
</span><a name="line-702"></a><span class="hs-comment">-- | Parallel inverse function composition,</span><span>
</span><a name="line-703"></a><span class="hs-comment">-- for those who read their programs from left to right.</span><span>
</span><a name="line-704"></a><span class="hs-comment">-- The result of the first function is evaluated using the</span><span>
</span><a name="line-705"></a><span class="hs-comment">-- given strategy, in parallel with the application of the</span><span>
</span><a name="line-706"></a><span class="hs-comment">-- second function.</span><span>
</span><a name="line-707"></a><span class="hs-special">(</span><span class="hs-operator">-||</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-708"></a><span class="hs-special">(</span><span class="hs-operator">-||</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">using</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-709"></a><span>                    </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">`</span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">par</span></a><span class="hs-special">`</span><span> </span><a href="Control.Parallel.Strategies.html#Strategy"><span class="hs-identifier hs-type">g</span></a><span> </span><a href="#local-1627413990"><span class="hs-identifier hs-type">z</span></a><span>
</span><a name="line-710"></a><span>
</span><a name="line-711"></a><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><a name="line-712"></a><span class="hs-comment">-- Old/deprecated stuff</span><span>
</span><a name="line-713"></a><span>
</span><a name="line-714"></a><span class="hs-pragma">{-# DEPRECATED Done &quot;The Strategy type is now a -&gt; Eval a, not a -&gt; Done&quot; #-}</span><span>
</span><a name="line-715"></a><span class="hs-comment">-- | DEPRECCATED: replaced by the 'Eval' monad</span><span>
</span><a name="line-716"></a><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Done</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-717"></a><span>
</span><a name="line-718"></a><span class="hs-pragma">{-# DEPRECATED demanding &quot;Use pseq or $| instead&quot; #-}</span><span>
</span><a name="line-719"></a><span class="hs-comment">-- | DEPRECATED: Use 'pseq' or '$|' instead</span><span>
</span><a name="line-720"></a><span class="hs-identifier">demanding</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Done</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-721"></a><span class="hs-identifier">demanding</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">flip</span><span> </span><span class="hs-identifier">pseq</span><span>
</span><a name="line-722"></a><span>
</span><a name="line-723"></a><span class="hs-pragma">{-# DEPRECATED sparking &quot;Use par or $|| instead&quot; #-}</span><span>
</span><a name="line-724"></a><span class="hs-comment">-- | DEPRECATED: Use 'par' or '$||' instead</span><span>
</span><a name="line-725"></a><span class="hs-identifier">sparking</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Done</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-726"></a><span class="hs-identifier">sparking</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">flip</span><span> </span><span class="hs-identifier">par</span><span>
</span><a name="line-727"></a><span>
</span><a name="line-728"></a><span class="hs-pragma">{-# DEPRECATED (&gt;|) &quot;Use pseq or $| instead&quot; #-}</span><span>
</span><a name="line-729"></a><span class="hs-comment">-- | DEPRECATED: Use 'pseq' or '$|' instead</span><span>
</span><a name="line-730"></a><span class="hs-special">(</span><span class="hs-operator">&gt;|</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Done</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Done</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Done</span><span>
</span><a name="line-731"></a><span class="hs-special">(</span><span class="hs-operator">&gt;|</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Prelude</span><span class="hs-operator">.</span><span class="hs-identifier">seq</span><span>
</span><a name="line-732"></a><span>
</span><a name="line-733"></a><span class="hs-pragma">{-# DEPRECATED (&gt;||) &quot;Use par or $|| instead&quot; #-}</span><span>
</span><a name="line-734"></a><span class="hs-comment">-- | DEPRECATED: Use 'par' or '$||' instead</span><span>
</span><a name="line-735"></a><span class="hs-special">(</span><span class="hs-operator">&gt;||</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Done</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Done</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Done</span><span>
</span><a name="line-736"></a><span class="hs-special">(</span><span class="hs-operator">&gt;||</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">par</span><span>
</span><a name="line-737"></a><span>
</span><a name="line-738"></a><span class="hs-pragma">{-# DEPRECATED rwhnf &quot;renamed to rseq&quot; #-}</span><span>
</span><a name="line-739"></a><span class="hs-comment">-- | DEPRECATED: renamed to 'rseq'</span><span>
</span><a name="line-740"></a><span class="hs-identifier">rwhnf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-741"></a><span class="hs-identifier">rwhnf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">rseq</span><span>
</span><a name="line-742"></a><span>
</span><a name="line-743"></a><span class="hs-pragma">{-# DEPRECATED seqTraverse &quot;renamed to evalTraversable&quot; #-}</span><span>
</span><a name="line-744"></a><span class="hs-comment">-- | DEPRECATED: renamed to 'evalTraversable'</span><span>
</span><a name="line-745"></a><span class="hs-identifier">seqTraverse</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-746"></a><span class="hs-identifier">seqTraverse</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">evalTraversable</span><span>
</span><a name="line-747"></a><span>
</span><a name="line-748"></a><span class="hs-pragma">{-# DEPRECATED parTraverse &quot;renamed to parTraversable&quot; #-}</span><span>
</span><a name="line-749"></a><span class="hs-comment">-- | DEPRECATED: renamed to 'parTraversable'</span><span>
</span><a name="line-750"></a><span class="hs-identifier">parTraverse</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-751"></a><span class="hs-identifier">parTraverse</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">parTraversable</span><span>
</span><a name="line-752"></a><span>
</span><a name="line-753"></a><span class="hs-pragma">{-# DEPRECATED parListWHNF &quot;use (parList rseq) instead&quot; #-}</span><span>
</span><a name="line-754"></a><span>
</span><a name="line-755"></a><span class="hs-pragma">{-# DEPRECATED seqList &quot;renamed to evalList&quot; #-}</span><span>
</span><a name="line-756"></a><span class="hs-comment">-- | DEPRECATED: renamed to 'evalList'</span><span>
</span><a name="line-757"></a><span class="hs-identifier">seqList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-758"></a><span class="hs-identifier">seqList</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">evalList</span><span>
</span><a name="line-759"></a><span>
</span><a name="line-760"></a><span class="hs-pragma">{-# DEPRECATED seqPair &quot;renamed to evalTuple2&quot; #-}</span><span>
</span><a name="line-761"></a><span class="hs-comment">-- | DEPRECATED: renamed to 'evalTuple2'</span><span>
</span><a name="line-762"></a><span class="hs-identifier">seqPair</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-763"></a><span class="hs-identifier">seqPair</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">evalTuple2</span><span>
</span><a name="line-764"></a><span>
</span><a name="line-765"></a><span class="hs-pragma">{-# DEPRECATED parPair &quot;renamed to parTuple2&quot; #-}</span><span>
</span><a name="line-766"></a><span class="hs-comment">-- | DEPRECATED: renamed to 'parTuple2'</span><span>
</span><a name="line-767"></a><span class="hs-identifier">parPair</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-768"></a><span class="hs-identifier">parPair</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">parTuple2</span><span>
</span><a name="line-769"></a><span>
</span><a name="line-770"></a><span class="hs-pragma">{-# DEPRECATED seqTriple &quot;renamed to evalTuple3&quot; #-}</span><span>
</span><a name="line-771"></a><span class="hs-comment">-- | DEPRECATED: renamed to 'evalTuple3'</span><span>
</span><a name="line-772"></a><span class="hs-identifier">seqTriple</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-773"></a><span class="hs-identifier">seqTriple</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">evalTuple3</span><span>
</span><a name="line-774"></a><span>
</span><a name="line-775"></a><span class="hs-pragma">{-# DEPRECATED parTriple &quot;renamed to parTuple3&quot; #-}</span><span>
</span><a name="line-776"></a><span class="hs-comment">-- | DEPRECATED: renamed to 'parTuple3'</span><span>
</span><a name="line-777"></a><span class="hs-identifier">parTriple</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strategy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-778"></a><span class="hs-identifier">parTriple</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">parTuple3</span><span>
</span><a name="line-779"></a><span>
</span><a name="line-780"></a><span class="hs-pragma">{-# DEPRECATED unEval &quot;renamed to runEval&quot; #-}</span><span>
</span><a name="line-781"></a><span class="hs-comment">-- | DEPRECATED: renamed to 'runEval'</span><span>
</span><a name="line-782"></a><span class="hs-identifier">unEval</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Eval</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-783"></a><span class="hs-identifier">unEval</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">runEval</span><span>
</span><a name="line-784"></a><span>
</span><a name="line-785"></a><span class="hs-comment">{- $history #history#

The strategies library has a long history.  What follows is a
summary of how the current design evolved, and is mostly of
interest to those who are familiar with an older version, or need
to adapt old code to use the newer API.

Version 1.x

  The original Strategies design is described in /Algorithm + Strategy = Parallelism/ &lt;http://www.macs.hw.ac.uk/~dsg/gph/papers/html/Strategies/strategies.html&gt;
  and the code was written by
     Phil Trinder, Hans-Wolfgang Loidl, Kevin Hammond et al.

Version 2.x

Later, during work on the shared-memory implementation of
parallelism in GHC, we discovered that the original formulation of
Strategies had some problems, in particular it lead to space leaks
and difficulties expressing speculative parallelism.  Details are in
the paper /Runtime Support for Multicore Haskell/ &lt;http://community.haskell.org/~simonmar/papers/multicore-ghc.pdf&gt;.

This module has been rewritten in version 2. The main change is to
the 'Strategy a' type synonym, which was previously @a -&gt; Done@ and
is now @a -&gt; Eval a@.  This change helps to fix the space leak described
in \&quot;Runtime Support for Multicore Haskell\&quot;.  The problem is that
the runtime will currently retain the memory referenced by all
sparks, until they are evaluated.  Hence, we must arrange to
evaluate all the sparks eventually, just in case they aren't
evaluated in parallel, so that they don't cause a space leak.  This
is why we must return a \&quot;new\&quot; value after applying a 'Strategy',
so that the application can evaluate each spark created by the
'Strategy'.

The simple rule is this: you /must/ use the result of applying
a 'Strategy' if the strategy creates parallel sparks, and you
should probably discard the the original value.  If you don't
do this, currently it may result in a space leak.  In the
future (GHC 6.14), it will probably result in lost parallelism
instead, as we plan to change GHC so that unreferenced sparks
are discarded rather than retained (we can't make this change
until most code is switched over to this new version of
Strategies, because code using the old verison of Strategies
would be broken by the change in policy).

The other changes in version 2.x are:

  * Strategies can now be defined using a convenient Monad/Applicative
    type, 'Eval'.  e.g. @parList s = traverse (Par . (``using`` s))@

  * 'parList' has been generalised to 'parTraverse', which works on
    any 'Traversable' type, and similarly 'seqList' has been generalised
    to 'seqTraverse'

  * 'parList' and 'parBuffer' have versions specialised to 'rwhnf',
    and there are transformation rules that automatically translate
    e.g. @parList rwnhf@ into a call to the optimised version.

  * 'NFData' has been moved to @Control.DeepSeq@ in the @deepseq@
    package.  Note that since the 'Strategy' type changed, 'rnf'
    is no longer a 'Strategy': use 'rdeepseq' instead.

Version 2.1 moved NFData into a separate package, @deepseq@.

Version 2.2 changed the type of Strategy to @a -&gt; Eval a@, and
re-introduced the @r0@ strategy which was missing in version 2.1.

Version 2.3 simplified the @Eval@ type, so that @Eval@ is now just
the strict identity monad.  This change and various other
improvements and refactorings are thanks to Patrick Maier who
noticed that @Eval@ didn't satisfy the monad laws, and that a
simpler version would fix that problem.

(version 2.3 was not released on Hackage).

Version 3 introduced a major overhaul of the API, to match what is
presented in the paper

  /Seq no More: Better Strategies for Parallel Haskell/
  &lt;http://community.haskell.org/~simonmar/papers/strategies.pdf&gt;

The major differenes in the API are:

 * The addition of Sequential strategies (&quot;Control.Seq&quot;) as
   a composable means for specifying sequential evaluation.

 * Changes to the naming scheme: 'rwhnf' renamed to 'rseq',
   'seqList' renamed to 'evalList', 'seqPair' renamed to
   'evalTuple2',

The naming scheme is now as follows:

  * Basic polymorphic strategies (of type @'Strategy' a@) are called @r...@.
    Examples: 'r0', 'rseq', 'rpar', 'rdeepseq'.

  * A strategy combinator for a particular type constructor
    or constructor class @T@ is called @evalT...@, @parT...@ or @seqT...@.

  * The @seqT...@ combinators (residing in module
     &quot;Control.Seq&quot;) yield sequential strategies.
     Thus, @seqT...@ combinators cannot spark, nor can the sequential
     strategies to which they may be applied.
     Examples: 'seqTuple2', 'seqListN', 'seqFoldable'.

  * The @evalT...@ combinators do not spark themselves, yet they may
     be applied to strategies that do spark. (They may also be applied
     to non-sparking strategies; however, in that case the corresponding
     @seqT...@ combinator might be a better choice.)
     Examples: 'evalTuple2', 'evalListN', 'evalTraversable'.

  * The @parT...@ combinators, which are derived from their @evalT...@
     counterparts, do spark. They may be applied to all strategies,
     whether sparking or not.
     Examples: 'parTuple2', 'parListN', 'parTraversable'.

  * An exception to the type driven naming scheme are 'evalBuffer' and
     'parBuffer', which are not named after their type constructor (lists)
     but after their function (rolling buffer of fixed size).
-}</span><span>
</span><a name="line-903"></a></pre></body></html>